<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ANKORMESSAJERY</title>

<style>
:root{
  --bg:#0f1220;
  --panel:#141a34;
  --chat:#151b36;
  --primary:#5c6cff;
  --accent:#2ee6a8;
  --text:white;
}

body.light{
  --bg:#ffffff;
  --panel:#e7ebff;
  --chat:#f4f6ff;
  --text:#121212;
}

/* RESET */
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial;
}

/* LOGIN BOX */
.box{
  max-width:380px;
  margin:70px auto;
  padding:25px;
  background:var(--panel);
  border-radius:12px;
}

input{
  width:100%;
  padding:10px;
  border-radius:7px;
  border:none;
  margin-top:8px;
  background:#1d2550;
  color:white;
}

button{
  padding:10px 14px;
  border:none;
  border-radius:8px;
  background:var(--primary);
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.hide{display:none;}

.avatar{
  width:40px;
  height:40px;
  border-radius:50%;
  background:var(--accent);
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:bold;
}

/* APP */
.app{
  display:flex;
  height:100vh;
}

.sidebar{
  width:220px;
  padding:12px;
  background:var(--panel);
}

.user{
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:6px;
}

.chat{
  flex:1;
  display:flex;
  flex-direction:column;
  background:var(--chat);
}

.chat-header{
  padding:12px;
  font-weight:bold;
  background:var(--panel);
}

.messages{
  flex:1;
  overflow-y:auto;
  padding:12px;
}

.message{
  display:flex;
  gap:10px;
  margin-bottom:10px;
  opacity:0;
  animation:fade .2s forwards;
}

@keyframes fade{
  to{opacity:1; transform:none;}
}

.message-text{
  background:#1d2550;
  padding:10px;
  border-radius:8px;
}

.input{
  padding:12px;
  display:flex;
  gap:10px;
  background:var(--panel);
}

@media(max-width:900px){
  .sidebar{display:none;}
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
  <h2>Entrar a ANKORMESSAJERY</h2>

  <input id="user" placeholder="Usuario">
  <input id="pass" type="password" placeholder="ContraseÃ±a">

  <button onclick="login()">Iniciar sesiÃ³n</button>
  <button onclick="register()">Registrar</button>
</div>

<!-- APP -->
<div class="app hide" id="app">

  <div class="sidebar">
    <h3>Usuarios</h3>
    <div id="users"></div>

    <hr>

    <button onclick="toggleTheme()">Modo claro/oscuro</button>
    <button style="background:red;margin-top:10px" onclick="logout()">Salir</button>
  </div>

  <div class="chat">
    <div class="chat-header">
      # general â€” ANKORMESSAJERY
    </div>

    <div class="messages" id="messages"></div>

    <div class="input">
      <input id="msg" placeholder="Escribe un mensaje...">
      <button onclick="send()">Enviar</button>
    </div>
  </div>

</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || {};
let session = localStorage.getItem("session");
let theme = localStorage.getItem("theme") || "dark";
if(theme==="light") document.body.classList.add("light");

function save(){localStorage.setItem("users",JSON.stringify(users));}

function login(){
  let u=user.value.trim(), p=pass.value.trim();
  if(!users[u] || users[u].password!==p) return alert("Datos incorrectos");
  session=u;
  localStorage.setItem("session",u);
  start();
}

function register(){
  let u=user.value.trim(), p=pass.value.trim();
  if(!u||!p) return alert("Completa todo");
  if(users[u]) return alert("Ya existe");
  users[u]={password:p,name:u,avatar:u[0].toUpperCase()};
  save();
  alert("Cuenta creada ðŸ˜„");
}

function logout(){
  localStorage.removeItem("session");
  session=null;
  location.reload();
}

function start(){
  loginBox.classList.add("hide");
  app.classList.remove("hide");
  renderUsers();
}

function renderUsers(){
  usersEl = document.getElementById("users");
  usersEl.innerHTML="";
  Object.values(users).forEach(u=>{
    usersEl.innerHTML+=`
      <div class="user">
        <div class="avatar">${u.avatar}</div>
        <span>${u.name}</span>
      </div>`;
  });
}

function send(){
  let t = msg.value.trim();
  if(!t) return;
  addMessage(users[session].avatar, users[session].name, t);
  msg.value="";
}

function addMessage(a,n,t){
  let box=document.getElementById("messages");
  let div=document.createElement("div");
  div.className="message";
  div.innerHTML=`
    <div class="avatar">${a}</div>
    <div class="message-text">
      <b>${n}</b><br>${t}
    </div>`;
  box.appendChild(div);
  box.scrollTop=box.scrollHeight;
}

function toggleTheme(){
  document.body.classList.toggle("light");
  localStorage.setItem("theme",
    document.body.classList.contains("light")?"light":"dark");
}

if(session) start();
</script>

</body>
</html>
